{"ast":null,"code":"import _defineProperty from \"/Users/lukehilliard/Desktop/NODEJS-ONLY/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/lukehilliard/Desktop/NODEJS-ONLY/client/src/components/Login/Register.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport { Redirect, Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { ACCESS_LEVEL_ADMIN, SERVER_HOST } from \"../../config/global_constants\";\nimport LinkInClass from \"../LinkInClass\";\nexport default class Register extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      let isNameValid = this.validateName();\n      let isEmailValid = this.validateEmail();\n      let isPasswordValid = this.validatePassword();\n      let isConfirmPasswordValid = this.validateConfirmPassword();\n\n      if (!isNameValid && !isEmailValid && !isPasswordValid && !isConfirmPasswordValid) // if inputs have passed validation\n        {\n          e.preventDefault();\n          axios.post(\"\".concat(SERVER_HOST, \"/users/Login/Register/\").concat(this.state.name, \"/\").concat(this.state.email, \"/\").concat(this.state.password)).then(res => {\n            if (res.data) {\n              if (res.data.errorMessage) {\n                console.log(res.data.errorMessage);\n              } else // user successfully registered\n                {\n                  console.log(\"User registered and logged in\");\n\n                  if (this.state.name === \"Admin\") {\n                    res.data.accessLevel = ACCESS_LEVEL_ADMIN;\n                  }\n\n                  sessionStorage.name = res.data.name;\n                  sessionStorage.accessLevel = res.data.accessLevel;\n                  this.setState({\n                    isRegistered: true\n                  });\n                }\n            } else {\n              console.log(\"Registration failed\");\n            }\n          });\n        } else {\n        console.log(\"Current values have not been posted\");\n      } // console.log(this.validateName())\n      // console.log(this.state.errors.name)\n      // console.log(this.state.errors.email)\n      // console.log(this.state.errors.password)\n      // console.log(this.state.errors.confirmPassword)\n\n    };\n\n    this.state = {\n      name: \"\",\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      isRegistered: false,\n      errors: {\n        // used to keep track of current validation errors\n        name: [],\n        email: [],\n        password: [],\n        confirmPassword: []\n      }\n    };\n  }\n\n  // Client side validation for Registration page\n  // if all of these return true the data will be posted\n  validateName() {\n    const name = this.state.name;\n    const errors = [];\n\n    if (/\\d/.test(name)) {\n      errors.push(\"Name cannot contain numbers\");\n    }\n\n    if (/[!\"£_'$*^&()+=#.-]/.test(name)) {\n      errors.push(\"Name cannot contain special characters\");\n    }\n\n    if (!name.trim()) {\n      errors.push(\"Name cannot be empty\");\n    } // update the state of name within errors with the current errors\n\n\n    this.setState(prevState => ({\n      errors: _objectSpread({}, prevState.errors, {\n        name: errors\n      })\n    })); //console.log(\"Errors for name: \", errors)\n\n    return errors.length !== 0;\n  }\n\n  validateEmail() {\n    const pattern = /^[a-zA-Z0-9_.-]+@[a-zA-Z]+.[a-zA-Z]+$/;\n    const email = this.state.email;\n    const errors = [];\n\n    if (!email.trim()) {\n      errors.push(\"Email cannot be empty\");\n    }\n\n    if (!pattern.test(email) && email.trim()) {\n      errors.push(\"Invalid email format\");\n    } // update the state of email within errors with the current errors\n\n\n    this.setState(prevState => ({\n      errors: _objectSpread({}, prevState.errors, {\n        email: errors\n      })\n    })); //console.log(\"Errors for email: \", errors)\n\n    return errors.length !== 0;\n  }\n\n  validatePassword() {\n    const specialCharPattern = /[!£_$*^&()+=#.-]/;\n    const password = this.state.password;\n    const errors = [];\n\n    if (password.length < 8) {\n      errors.push(\"Password must be > 8 characters long\");\n    }\n\n    if (!/[0-9]/.test(password)) {\n      errors.push(\"Password must contain at least 1 number \");\n    }\n\n    if (!specialCharPattern.test(password)) {\n      errors.push(\"Password must contain at least 1 special character !£_$*^&()+=#.-\");\n    } // update the state of password within errors with the current errors\n\n\n    this.setState(prevState => ({\n      errors: _objectSpread({}, prevState.errors, {\n        password: errors\n      })\n    })); //console.log(\"Errors for password: \", errors)\n\n    return errors.length !== 0;\n  }\n\n  validateConfirmPassword() {\n    const errors = [];\n\n    if (this.state.password !== this.state.confirmPassword) {\n      errors.push(\"Passwords do not match\");\n    } // update the state of confirmPassword within errors with current errors\n\n\n    this.setState(prevState => ({\n      errors: _objectSpread({}, prevState.errors, {\n        confirmPassword: errors\n      })\n    })); //console.log(\"Errors for confirmPassword: \", errors)\n\n    return errors.length !== 0;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"register-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"Registration\"), React.createElement(\"form\", {\n      className: \"register-form\",\n      noValidate: true,\n      id: \"loginOrRegistrationForm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, this.state.isRegistered ? React.createElement(Redirect, {\n      to: \"/DisplayProducts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }) : null, React.createElement(\"input\", {\n      name: \"name\",\n      type: \"text\",\n      placeholder: \"Name\",\n      autoComplete: \"name\",\n      value: this.state.name,\n      onChange: this.handleChange,\n      ref: input => {\n        this.inputToFocus = input;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }), this.state.errors.name.length > 0 && this.state.errors.name.map((error, index) => React.createElement(\"div\", {\n      key: index,\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"\\u2022 \", error)), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      name: \"email\",\n      type: \"email\",\n      placeholder: \"Email\",\n      autoComplete: \"email\",\n      value: this.state.email,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), this.state.errors.email.length > 0 && this.state.errors.email.map((error, index) => React.createElement(\"div\", {\n      key: index,\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, \"\\u2022 \", error)), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      name: \"password\",\n      type: \"password\",\n      placeholder: \"Password\",\n      autoComplete: \"password\",\n      value: this.state.password,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }), this.state.errors.password.length > 0 ? React.createElement(\"div\", {\n      className: \"password-error-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, this.state.errors.password.map((error, index) => React.createElement(\"div\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, \"\\u2022 \", error))) : null, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      name: \"confirmPassword\",\n      type: \"password\",\n      placeholder: \"Confirm password\",\n      autoComplete: \"confirmPassword\",\n      value: this.state.confirmPassword,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }), this.state.errors.confirmPassword.length > 0 && this.state.errors.confirmPassword.map((error, index) => React.createElement(\"div\", {\n      key: index,\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, \"\\u2022 \", error)), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"register-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, React.createElement(LinkInClass, {\n      value: \"Register New User\",\n      className: \"green-button\",\n      onClick: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }), \" \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }), React.createElement(Link, {\n      className: \"red-button\",\n      to: \"/TestingDirectory\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, \"Cancel\"))));\n  }\n\n}","map":{"version":3,"sources":["/Users/lukehilliard/Desktop/NODEJS-ONLY/client/src/components/Login/Register.js"],"names":["React","Component","Redirect","Link","axios","ACCESS_LEVEL_ADMIN","SERVER_HOST","LinkInClass","Register","constructor","props","handleChange","e","setState","target","name","value","handleSubmit","isNameValid","validateName","isEmailValid","validateEmail","isPasswordValid","validatePassword","isConfirmPasswordValid","validateConfirmPassword","preventDefault","post","state","email","password","then","res","data","errorMessage","console","log","accessLevel","sessionStorage","isRegistered","confirmPassword","errors","test","push","trim","prevState","length","pattern","specialCharPattern","render","input","inputToFocus","map","error","index"],"mappings":"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","sourcesContent":["import React,{Component} from \"react\"\nimport {Redirect, Link} from \"react-router-dom\"\nimport axios from \"axios\"\nimport {ACCESS_LEVEL_ADMIN, SERVER_HOST} from \"../../config/global_constants\"\nimport LinkInClass from \"../LinkInClass\";\nexport default class Register extends Component{\n    constructor(props) {\n        super(props);\n        this.state={\n            name:\"\",\n            email:\"\",\n            password:\"\",\n            confirmPassword:\"\",\n            isRegistered:false,\n            errors: { // used to keep track of current validation errors\n                name: [],\n                email: [],\n                password: [],\n                confirmPassword: []\n            }\n        }\n    }\n    handleChange = (e) =>\n    {\n        this.setState({[e.target.name]: e.target.value})\n    }\n\n    // Client side validation for Registration page\n    // if all of these return true the data will be posted\n    validateName()\n    {\n        const name = this.state.name\n        const errors = [];\n\n\n        if(/\\d/.test(name)) {\n            errors.push(\"Name cannot contain numbers\")\n        }\n        if(/[!\"£_'$*^&()+=#.-]/.test(name)) {\n            errors.push(\"Name cannot contain special characters\")\n        }\n        if(!name.trim()) {\n            errors.push(\"Name cannot be empty\")\n        }\n\n        // update the state of name within errors with the current errors\n        this.setState(prevState => ({\n            errors: {\n                ...prevState.errors,\n                name: errors\n            }\n        }))\n        //console.log(\"Errors for name: \", errors)\n        return errors.length !== 0\n    }\n    validateEmail()\n    {\n        const pattern = /^[a-zA-Z0-9_.-]+@[a-zA-Z]+.[a-zA-Z]+$/\n        const email = this.state.email\n        const errors = []\n\n\n        if(!email.trim()) {\n            errors.push(\"Email cannot be empty\")\n        }\n        if(!pattern.test(email) && email.trim()) {\n            errors.push(\"Invalid email format\")\n        }\n\n        // update the state of email within errors with the current errors\n        this.setState(prevState => ({\n            errors: {\n                ...prevState.errors,\n                email: errors\n            }\n        }))\n        //console.log(\"Errors for email: \", errors)\n        return errors.length !== 0\n    }\n    validatePassword()\n    {\n        const specialCharPattern = /[!£_$*^&()+=#.-]/\n        const password = this.state.password\n        const errors = []\n\n\n        if(password.length < 8) {\n            errors.push(\"Password must be > 8 characters long\")\n        }\n        if(!/[0-9]/.test(password)) {\n            errors.push(\"Password must contain at least 1 number \")\n        }\n        if(!specialCharPattern.test(password)) {\n            errors.push(\"Password must contain at least 1 special character !£_$*^&()+=#.-\")\n        }\n\n        // update the state of password within errors with the current errors\n        this.setState(prevState => ({\n            errors: {\n                ...prevState.errors,\n                password: errors\n            }\n        }))\n        //console.log(\"Errors for password: \", errors)\n        return errors.length !== 0\n    }\n    validateConfirmPassword()\n    {\n        const errors = []\n\n\n        if(this.state.password !== this.state.confirmPassword) {\n            errors.push(\"Passwords do not match\")\n        }\n\n        // update the state of confirmPassword within errors with current errors\n        this.setState(prevState => ({\n            errors: {\n                ...prevState.errors,\n                confirmPassword: errors\n            }\n        }))\n\n        //console.log(\"Errors for confirmPassword: \", errors)\n        return errors.length !== 0\n    }\n\n    handleSubmit=(e)=> {\n        let isNameValid = this.validateName()\n        let isEmailValid = this.validateEmail()\n        let isPasswordValid = this.validatePassword()\n        let isConfirmPasswordValid = this.validateConfirmPassword()\n        if(!isNameValid && !isEmailValid && !isPasswordValid && !isConfirmPasswordValid) // if inputs have passed validation\n        {\n            e.preventDefault()\n            axios.post(`${SERVER_HOST}/users/Login/Register/${this.state.name}/${this.state.email}/${this.state.password}`)\n                .then(res =>\n                {\n                    if(res.data)\n                    {\n                        if (res.data.errorMessage)\n                        {\n                            console.log(res.data.errorMessage)\n                        }\n                        else // user successfully registered\n                        {\n                            console.log(\"User registered and logged in\")\n                            if (this.state.name===\"Admin\"){\n                                res.data.accessLevel=ACCESS_LEVEL_ADMIN\n                            }\n                            sessionStorage.name = res.data.name\n                            sessionStorage.accessLevel = res.data.accessLevel\n\n                            this.setState({isRegistered:true})\n                        }\n\n                    }else{\n                        console.log(\"Registration failed\")\n                    }\n                })\n        } else {\n\n            console.log(\"Current values have not been posted\")\n        }\n        // console.log(this.validateName())\n        // console.log(this.state.errors.name)\n        // console.log(this.state.errors.email)\n        // console.log(this.state.errors.password)\n        // console.log(this.state.errors.confirmPassword)\n\n    }\nrender(){\n        return(\n            <div className=\"register-container\">\n                <h2>Registration</h2>\n\n                    <form className=\"register-form\" noValidate = {true} id = \"loginOrRegistrationForm\">\n                        {this.state.isRegistered ? <Redirect to=\"/DisplayProducts\"/> : null}\n\n                        {/*  &#x2022; == unicode for bullet point  */}\n                        <input\n                            name = \"name\"\n                            type = \"text\"\n                            placeholder = \"Name\"\n                            autoComplete=\"name\"\n                            value = {this.state.name}\n                            onChange = {this.handleChange}\n                            ref = {(input) => { this.inputToFocus = input }}\n                        />\n                        {this.state.errors.name.length > 0 && this.state.errors.name.map((error, index) => (\n                            <div key={index} className=\"error-message\">\n                                &#x2022; {error}\n                            </div>\n                        ))}\n                        <br/>\n\n                        <input\n                            name = \"email\"\n                            type = \"email\"\n                            placeholder = \"Email\"\n                            autoComplete=\"email\"\n                            value = {this.state.email}\n                            onChange = {this.handleChange}\n                        />\n                        {this.state.errors.email.length > 0 && this.state.errors.email.map((error, index) => (\n                            <div key={index} className=\"error-message\">\n                                &#x2022; {error}\n                            </div>\n                        ))}\n                        <br/>\n\n                        <input\n                            name = \"password\"\n                            type = \"password\"\n                            placeholder = \"Password\"\n                            autoComplete=\"password\"\n                            value = {this.state.password}\n                            onChange = {this.handleChange}\n                        />\n                        {this.state.errors.password.length > 0 ? (\n                            <div className=\"password-error-container\">\n                                {this.state.errors.password.map((error, index) => (\n                                    <div key={index}>\n                                        &#x2022; {error}\n                                    </div>\n                                ))}\n                            </div>\n                        ) : null}\n\n                        <br/>\n\n                        <input\n                            name = \"confirmPassword\"\n                            type = \"password\"\n                            placeholder = \"Confirm password\"\n                            autoComplete=\"confirmPassword\"\n                            value = {this.state.confirmPassword}\n                            onChange = {this.handleChange}\n                        />\n\n                        {this.state.errors.confirmPassword.length > 0 && this.state.errors.confirmPassword.map((error, index) => (\n                            <div key={index} className=\"error-message\">\n                                &#x2022; {error}\n                            </div>\n                        ))}\n                        <br/><br/>\n\n                        <div className=\"register-buttons\">\n                            <LinkInClass value=\"Register New User\" className=\"green-button\" onClick={this.handleSubmit} /> <br/>\n                            <Link className=\"red-button\" to={\"/TestingDirectory\"}>Cancel</Link>\n                        </div>\n                    </form>\n                </div>\n\n\n\n        )}\n}"]},"metadata":{},"sourceType":"module"}